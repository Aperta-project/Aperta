#!/usr/bin/env bash

# `set -xe` causes this whole script to immediately exit if any single command fails
set -xe

bundle exec rake db:drop
# manually check that the DB was dropped because rake db:drop will exit with success even if it failed
psql -l | grep tahi_development && exit 1

# Get the DB up to date with master
# If you are working on a hotfix you should get up to date with the release branch instead of master
git checkout master
bundle exec rake db:setup

# Go back to the feature branch
git checkout -
# migrate and dump seed data
bundle exec rake db:dump_seed_data
