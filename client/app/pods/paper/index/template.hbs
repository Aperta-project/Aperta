{{paper-control-bar paper=model
                    showActivity="showActivityOverlay"
                    addContributors="showCollaboratorsOverlay"
                    exportDocument="exportDocument"
                    showWithdrawOverlay="showWithdrawOverlay"
                    topicsIndexPath=topicsIndexPath
                    canViewManuscriptManager=canViewManuscriptManager
                    supportedDownloadFormats=supportedDownloadFormats
                    versionsVisible=versioningMode}}

{{withdrawal-banner paper=model staff=currentUser.siteAdmin}}

{{#paper-submission-process showProcess=showSubmissionProcess
                            toggle=(action "toggleSubmissionProcess")}}
  {{#split-pane id="paper-container"
                handleClass="manuscript-handle"}}
    {{#split-pane-element class="manuscript-pane"}}
      <div class="manuscript-container">
        {{flash-messages}}
        <div class="manuscript">
          {{#if model.editable}}
            {{content-editable tagName="h2"
                               id="paper-title"
                               value=model.title
                               preventEnterKey="true"
                               placeholder="Type your manuscript title here"
                               key-up=(action "saveManuscriptTitle")
                               focus-out=(action "saveManuscriptTitle")}}
          {{else}}
            <h2 id="paper-title">{{{model.title}}}</h2>
          {{/if}}

          <div class="paper-body">
            {{{model.body}}}
          </div>
        </div>
      </div>
    {{/split-pane-element}}

    {{#split-pane-element}}
      {{paper-sidebar paper=model
                      user=currentUser
                      commentLooks=commentLooks
                      showPaperSubmitOverlay=(action "showPaperSubmitOverlay")
                      toggleSubmissionProcess=(action "toggleSubmissionProcess")}}
    {{/split-pane-element}}
  {{/split-pane}}
{{/paper-submission-process}}

{{outlet}}

{{#overlay-fullscreen visible=showActivityOverlay
                      outAnimationComplete=(action "hideActivityOverlay")
                      title="Recent Activity"
                      overlayClass="activity-overlay"
                      as |overlay|}}
    {{paper-activity isLoading=activityIsLoading
                     model=activityFeed
                     close=(action overlay.animateOut)}}
{{/overlay-fullscreen}}


{{#overlay-fullscreen visible=showCollaboratorsOverlay
                      outAnimationComplete=(action "hideCollaboratorsOverlay")
                      title="Who can collaborate on this manuscript?"
                      overlayClass="show-collaborators-overlay"
                      as |overlay|}}
    {{paper-collaborators paper=model
                          close=(action overlay.animateOut)}}
{{/overlay-fullscreen}}


{{#overlay-fullscreen visible=showWithdrawOverlay
                      outAnimationComplete=(action "hideWithdrawOverlay")
                      overlayClass="overlay--grey paper-withdraw-overlay"
                      as |overlay|}}
    {{paper-withdraw model=model
                     close=(action overlay.animateOut)}}
{{/overlay-fullscreen}}


{{#overlay-fullscreen visible=showPaperSubmitOverlay
                      outAnimationComplete=(action "hidePaperSubmitOverlay")
                      overlayClass="overlay--green paper-submit-overlay"
                      as |overlay|}}
    {{paper-submit model=model
                   close=(action overlay.animateOut)}}
{{/overlay-fullscreen}}
