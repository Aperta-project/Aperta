if("undefined"==typeof CSL_IS_IE)var CSL_IS_IE;var CSL_CHROME=function(){"undefined"==typeof DOMParser||CSL_IS_IE?(CSL_IS_IE=!0,DOMParser=function(){},DOMParser.prototype.parseFromString=function(a,b){if("undefined"!=typeof ActiveXObject){var c=new ActiveXObject("MSXML.DomDocument");return c.async=!1,c.loadXML(a),c}if("undefined"!=typeof XMLHttpRequest){var c=new XMLHttpRequest;return b||(b="text/xml"),c.open("GET","data:"+b+";charset=utf-8,"+encodeURIComponent(a),!1),c.overrideMimeType&&c.overrideMimeType(b),c.send(null),c.responseXML}},this.hasAttributes=function(a){var b;return b=a.attributes&&a.attributes.length?!0:!1}):this.hasAttributes=function(a){var b;return b=a.attributes&&a.attributes.length?!0:!1},this.importNode=function(a,b){if("undefined"==typeof a.importNode)var c=this._importNode(a,b,!0);else var c=a.importNode(b,!0);return c},this._importNode=function(a,b,c){switch(b.nodeType){case 1:var d=a.createElement(b.nodeName);if(b.attributes&&b.attributes.length>0)for(var e=0,f=b.attributes.length;f>e;)d.setAttribute(b.attributes[e].nodeName,b.getAttribute(b.attributes[e++].nodeName));if(c&&b.childNodes&&b.childNodes.length>0)for(var e=0,f=b.childNodes.length;f>e;)d.appendChild(this._importNode(a,b.childNodes[e++],c));return d;case 3:case 4:case 8:}},this.parser=new DOMParser;var a='<docco><institution institution-parts="long" delimiter=", " substitute-use-first="1" use-last="1"><institution-part name="long"/></institution></docco>',b=this.parser.parseFromString(a,"text/xml"),c=b.getElementsByTagName("institution");this.institution=c.item(0);var d=b.getElementsByTagName("institution-part");this.institutionpart=d.item(0),this.ns="http://purl.org/net/xbiblio/csl"};CSL_CHROME.prototype.clean=function(a){return a=a.replace(/<\?[^?]+\?>/g,""),a=a.replace(/<![^>]+>/g,""),a=a.replace(/^\s+/,""),a=a.replace(/\s+$/,""),a=a.replace(/^\n*/,"")},CSL_CHROME.prototype.getStyleId=function(a){var b="",c=a.getElementsByTagName("id");return c&&c.length&&(c=c.item(0)),c&&(b=c.textContent),b||(b=c.innerText),b||(b=c.innerHTML),b},CSL_CHROME.prototype.children=function(a){var b,c,d,e;if(a){for(e=[],b=a.childNodes,c=0,d=b.length;d>c;c+=1)"#text"!=b[c].nodeName&&e.push(b[c]);return e}return[]},CSL_CHROME.prototype.nodename=function(a){var b=a.nodeName;return b},CSL_CHROME.prototype.attributes=function(a){var b,c,d,g,h;if(b=new Object,a&&this.hasAttributes(a))for(c=a.attributes,g=0,h=c.length;h>g;g+=1)d=c[g],b["@"+d.name]=d.value;return b},CSL_CHROME.prototype.content=function(a){var b;return b="undefined"!=typeof a.textContent?a.textContent:"undefined"!=typeof a.innerText?a.innerText:a.txt},CSL_CHROME.prototype.namespace={xml:"http://www.w3.org/XML/1998/namespace"},CSL_CHROME.prototype.numberofnodes=function(a){return a?a.length:0},CSL_CHROME.prototype.getAttributeName=function(a){var b=a.name;return b},CSL_CHROME.prototype.getAttributeValue=function(a,b,c){var d=!1;return c&&(b=c+":"+b),a&&this.hasAttributes(a)?a.getAttribute(b)&&(d=a.getAttribute(b)):d="",d},CSL_CHROME.prototype.getNodeValue=function(a,b){var c="";if(b){var d=a.getElementsByTagName(b);d.length>0&&(c="undefined"!=typeof d[0].textContent?d[0].textContent:"undefined"!=typeof d[0].innerText?d[0].innerText:d[0].text)}else c=a;return c&&c.childNodes&&(0==c.childNodes.length||1==c.childNodes.length&&"#text"==c.firstChild.nodeName)&&(c="undefined"!=typeof c.textContent?c.textContent:"undefined"!=typeof c.innerText?c.innerText:c.text),c},CSL_CHROME.prototype.setAttributeOnNodeIdentifiedByNameAttribute=function(a,b,c,d,e){var f,g,i,j;for("@"===d.slice(0,1)&&(d=d.slice(1)),i=a.getElementsByTagName(b),f=0,g=i.length;g>f;f+=1)j=i[f],j.getAttribute("name")==c&&j.setAttribute(d,e)},CSL_CHROME.prototype.deleteNodeByNameAttribute=function(a,b){var c,d,e,f;for(f=a.childNodes,c=0,d=f.length;d>c;c+=1)e=f[c],e&&e.nodeType!=e.TEXT_NODE&&this.hasAttributes(e)&&e.getAttribute("name")==b&&a.removeChild(f[c])},CSL_CHROME.prototype.deleteAttribute=function(a,b){a.removeAttribute(b)},CSL_CHROME.prototype.setAttribute=function(a,b,c){return a.ownerDocument||(a=a.firstChild),["function","unknown"].indexOf(typeof a.setAttribute)>-1&&a.setAttribute(b,c),!1},CSL_CHROME.prototype.nodeCopy=function(a){var b=a.cloneNode(!0);return b},CSL_CHROME.prototype.getNodesByName=function(a,b,c){var d,e,f,g,h;for(d=[],e=a.getElementsByTagName(b),g=0,h=e.length;h>g;g+=1)f=e.item(g),(!c||this.hasAttributes(f)&&f.getAttribute("name")==c)&&d.push(f);return d},CSL_CHROME.prototype.nodeNameIs=function(a,b){return b==a.nodeName?!0:!1},CSL_CHROME.prototype.makeXml=function(a){a||(a="<docco><bogus/></docco>"),a=a.replace(/\s*<\?[^>]*\?>\s*\n*/g,"");var d=this.parser.parseFromString(a,"application/xml");return d.firstChild},CSL_CHROME.prototype.insertChildNodeAfter=function(a,b,c,d){var e;return e=this.importNode(b.ownerDocument,d),a.replaceChild(e,b),a},CSL_CHROME.prototype.insertPublisherAndPlace=function(a){for(var b=a.getElementsByTagName("group"),c=0,d=b.length;d>c;c+=1){for(var e=b.item(c),f=[],g=0,h=e.childNodes.length;h>g;g+=1)1!==e.childNodes.item(g).nodeType&&f.push(g);if(2===e.childNodes.length-f.length){for(var i=[],g=0,h=2;h>g;g+=1)if(!(f.indexOf(g)>-1)){for(var j=e.childNodes.item(g),k=[],l=0,m=j.childNodes.length;m>l;l+=1)1!==j.childNodes.item(l).nodeType&&k.push(l);if(0===j.childNodes.length-k.length&&(i.push(j.getAttribute("variable")),j.getAttribute("suffix")||j.getAttribute("prefix"))){i=[];break}}i.indexOf("publisher")>-1&&i.indexOf("publisher-place")>-1&&e.setAttribute("has-publisher-and-publisher-place",!0)}}},CSL_CHROME.prototype.addMissingNameNodes=function(a){for(var b=a.getElementsByTagName("names"),c=0,d=b.length;d>c;c+=1){var e=b.item(c),f=e.getElementsByTagName("name");if((!f||0===f.length)&&"substitute"!==e.parentNode.tagName.toLowerCase()){var g=e.ownerDocument,h=g.createElement("name");e.appendChild(h)}}},CSL_CHROME.prototype.addInstitutionNodes=function(a){var b,c,d,e,f,g,i,j;for(b=a.getElementsByTagName("names"),i=0,j=b.length;j>i;i+=1)if(c=b.item(i),f=c.getElementsByTagName("name"),0!=f.length&&(d=c.getElementsByTagName("institution"),0==d.length)){e=this.importNode(a.ownerDocument,this.institution),theinstitutionpart=e.getElementsByTagName("institution-part").item(0),g=f.item(0),c.insertBefore(e,g.nextSibling);for(var k=0,l=CSL.INSTITUTION_KEYS.length;l>k;k+=1){var m=CSL.INSTITUTION_KEYS[k],n=g.getAttribute(m);n&&theinstitutionpart.setAttribute(m,n)}for(var o=g.getElementsByTagName("name-part"),k=0,l=o.length;l>k;k+=1)if("family"===o[k].getAttribute("name"))for(var p=0,q=CSL.INSTITUTION_KEYS.length;q>p;p+=1){var m=CSL.INSTITUTION_KEYS[p],n=o[k].getAttribute(m);n&&theinstitutionpart.setAttribute(m,n)}}},CSL_CHROME.prototype.flagDateMacros=function(a){var b,c,d,e;for(nodes=a.getElementsByTagName("macro"),b=0,c=nodes.length;c>b;b+=1)d=nodes.item(b),e=d.getElementsByTagName("date"),e.length&&d.setAttribute("macro-has-date","true")};