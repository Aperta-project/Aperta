{{!-- Copyright (c) 2018 Public Library of Science --}}

{{!-- Permission is hereby granted, free of charge, to any person obtaining a --}}
{{!-- copy of this software and associated documentation files (the "Software"), --}}
{{!-- to deal in the Software without restriction, including without limitation --}}
{{!-- the rights to use, copy, modify, merge, publish, distribute, sublicense, --}}
{{!-- and/or sell copies of the Software, and to permit persons to whom the --}}
{{!-- Software is furnished to do so, subject to the following conditions: --}}

{{!-- The above copyright notice and this permission notice shall be included in --}}
{{!-- all copies or substantial portions of the Software. --}}

{{!-- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR --}}
{{!-- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, --}}
{{!-- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL --}}
{{!-- THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER --}}
{{!-- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING --}}
{{!-- FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER --}}
{{!-- DEALINGS IN THE SOFTWARE. --}}

<p>
  Fields marked with an <i class="correspondence-asterisk-field">*</i> are required.
</p>

<div class="row">
  <div class="col-sm-6 col-md-3">
    <label class="correspondence-label">Date sent</label>
    <div class="{{if validationErrors.dateSent "error"}}">
      {{date-picker name='correspondence-date-sent'
                    value=dateSent
                    date=dateSent
                    placeholder="Select date..."
                    class="correspondence-date-sent correspondence-input"}}
    </div>
    <span>
      {{error-message message=validationErrors.dateSent
                      class="correspondence-error"
                      displayIcon=true
                      displayText=true}}
    </span>
  </div>
  <div class="col-sm-6 col-md-3">
    <label class="correspondence-label">Time sent</label>
    <div class="{{if validationErrors.timeSent "error"}}">
      {{time-picker class="correspondence-time-sent correspondence-input"
                    name='correspondence-time-sent'
                    value=timeSent}}
    </div>
    <span>
      {{error-message message=validationErrors.timeSent
                      class="correspondence-error"
                      displayIcon=true
                      displayText=true}}
    </span>
  </div>
</div>
<div class="row">
  <div class="col-sm-12">
    <label class="correspondence-label">Description</label>
    <div class="{{if validationErrors.description "error"}}">
      {{input type="text"
              name='correspondence-description'
              value=model.description
              class="correspondence-description correspondence-input"}}
    </div>
    <span>
      {{error-message message=validationErrors.description
                      class="correspondence-error"
                      displayIcon=true
                      displayText=true}}
    </span>
  </div>
</div>
<div class="row">
  <div class="col-sm-12">
    <label class="correspondence-label">From</label>
    <div class="{{if validationErrors.sender "error"}}">
      {{input type="text"
              name='correspondence-from'
              value=model.sender
              class="correspondence-from correspondence-input"}}
    </div>
    <span>
      {{error-message message=validationErrors.sender
                      class="correspondence-error"
                      displayIcon=true
                      displayText=true}}
    </span>
  </div>
</div>
<div class="row">
  <div class="col-sm-12">
    <label class="correspondence-label">To</label>
    <div class="{{if validationErrors.recipients "error"}}">
      {{input type="text"
              name='correspondence-to'
              value=model.recipients
              class="correspondence-to correspondence-input"}}
    </div>
    <span>
      {{error-message message=validationErrors.recipients
                      class="correspondence-error"
                      displayIcon=true
                      displayText=true}}
    </span>
  </div>
</div>
<div class="row">
  <div class="col-sm-12">
    <label>Subject</label>
    <div>
      {{input type="text"
              name='correspondence-subject'
              value=model.subject
              class="correspondence-subject correspondence-input"}}
    </div>
    <span>
      {{error-message message=validationErrors.subject
                      class="correspondence-error"
                      displayIcon=true
                      displayText=true}}
    </span>
  </div>
</div>
<div class="row">
  <div class="col-sm-12">
    <label>CC</label>
    <div>
      {{input type="text"
              name='correspondence-cc'
              value=model.cc
              class="correspondence-cc correspondence-input"}}
    </div>
    <span>
      {{error-message message=validationErrors.cc
                      class="correspondence-error"
                      displayIcon=true
                      displayText=true}}
    </span>
  </div>
</div>
<div class="row">
  <div class="col-sm-12">
    <label>BCC</label>
    <div class="inset-form-control">
      {{input type="text"
              name='correspondence-bcc'
              value=model.bcc
              class="correspondence-bcc correspondence-input"}}
    </div>
    <span>
      {{error-message message=validationErrors.bcc
                      class="correspondence-error"
                      displayIcon=true
                      displayText=true}}
    </span>
  </div>
</div>
<div class="row">
  <div class="col-sm-12">
      {{attachment-manager accept=".jpg,.jpeg,.tiff,.tif,.gif,.png,.pdf,.docx,.doc,.pages"
                           filePath="correspondence_attachment"
                           attachments=attachments
                           multiple=true
                           disabled=false
                           hasCaption=false
                           buttonText="Attach Files"
                           showDescription=false
                           uploadFinished=(action "createAttachment")
                           updateAttachment=(action "updateAttachment") }}
  </div>
</div>
<div class="row">
  <p>&nbsp;</p>
</div>
<div class="row">
  <div class="col-sm-12">
    <div class="form-group">
      <label class="correspondence-label">
        Contents
      </label>
      <div class="{{if validationErrors.body "error"}}">
        {{rich-text-editor
          editorStyle='basic'
          ident='correspondence-body'
          value=model.body
          name="correspondence-body"
          class="correspondence-body input"
          onContentsChanged=(action 'saveContentsBody')
          disabled=false
        }}
      </div>
      {{error-message message=validationErrors.body
                          class="correspondence-error"
                          displayIcon=true
                          displayText=true}}
    </div>
  </div>
</div>
 <div class="overlay-footer-content correspondence-form-footer-content">
  <div class="overlay-action-buttons">
    {{#if close}}
      <button class="button-link button--green" {{action close}}>cancel</button>
    {{/if}}
    <button class="button button--green button-primary correspondence-submit" {{action "submit" model}}>{{saveText}}</button>
  </div>
</div>
